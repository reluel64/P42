import os
import shutil
VariantDir('build/src','src',duplicate=0 )
VariantDir('build/asm','asm',duplicate=0 )

env=Environment(
                ENV       = {'PATH' : os.environ['PATH']},
                CCFLAGS   = '-ffreestanding -mno-red-zone -mno-mmx -mno-sse -mno-sse2 -mcmodel=kernel',
                LINKFLAGS = '-T linker.ld -lgcc -z max-page-size=0x1000 -ffreestanding -nostdlib',
                CC        = 'x86_64-elf-gcc',
                CPPPATH   = 'h',
                ASFLAGS   = '-felf64',
                tools     =['default', 'nasm'],
               )

direc = env.Dir('TestDir')

kernel = env.Program(
                    target = 'kernel.bin', 
                    source=[Glob('build/src/*.c'), Glob('build/asm/*.asm')]
                    )

env.Install('/media/alex/4D7E-2E98', kernel)
env.Alias('install','/media/alex/4D7E-2E98')
